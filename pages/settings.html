<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Settings - eVidya</title>
		<!-- Bootstrap CSS -->
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
		<!-- Font Awesome -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
		/>
		<!-- Google Fonts -->
		<link
			href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<link rel="stylesheet" href="../css/style.css" />
		<style>
			body {
				font-family: "Poppins", sans-serif;
				background-color: #f9fafb;
			}

			header {
				background: linear-gradient(135deg, var(--primary-color), #0d47a1);
				padding: 3rem 0;
				margin-bottom: 0;
			}

			.settings-container {
				max-width: 900px;
				margin: 0 auto;
			}

			.settings-card {
				background: #fff;
				border-radius: 10px;
				box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
				padding: 2rem;
				margin-bottom: 2rem;
			}

			.settings-card h3 {
				margin-bottom: 1.5rem;
				color: var(--primary-color);
				border-bottom: 1px solid #eee;
				padding-bottom: 0.75rem;
			}

			.form-group {
				margin-bottom: 1.5rem;
			}

			.form-label {
				font-weight: 500;
				margin-bottom: 0.5rem;
				display: block;
			}

			.form-text {
				font-size: 0.85rem;
				color: #6c757d;
				margin-top: 0.25rem;
			}

			.settings-footer {
				display: flex;
				justify-content: flex-end;
				gap: 1rem;
				margin-top: 1rem;
			}

			.api-status {
				display: inline-block;
				padding: 0.3rem 0.6rem;
				border-radius: 50px;
				font-size: 0.75rem;
				font-weight: 500;
				margin-left: 0.5rem;
			}

			.status-active {
				background-color: #d1e7dd;
				color: #0f5132;
			}

			.status-inactive {
				background-color: #f8d7da;
				color: #842029;
			}

			.input-group-text {
				cursor: pointer;
				transition: all 0.2s;
			}

			.input-group-text:hover {
				background-color: #e9ecef;
			}

			.get-api-link {
				display: block;
				margin-top: 0.5rem;
				font-size: 0.85rem;
			}
		</style>
	</head>
	<body>
		<header>
			<nav class="navbar navbar-expand-lg navbar-dark">
				<div class="container">
					<a class="navbar-brand" href="../index.html">
						<h2>eVidya Learning</h2>
					</a>
					<button
						class="navbar-toggler"
						type="button"
						data-bs-toggle="collapse"
						data-bs-target="#navbarMain"
						aria-controls="navbarMain"
						aria-expanded="false"
						aria-label="Toggle navigation"
					>
						<span class="navbar-toggler-icon"></span>
					</button>
					<div class="collapse navbar-collapse" id="navbarMain">
						<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
							<li class="nav-item">
								<a class="nav-link" href="../index.html">
									<i class="fas fa-home me-1"></i> Home
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="./catalogue.html">
									<i class="fas fa-book me-1"></i> Courses
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="./profile.html">
									<i class="fas fa-user me-1"></i> Profile
								</a>
							</li>
							<li class="nav-item">
								<a
									class="nav-link active"
									href="./settings.html"
								>
									<i class="fas fa-cog me-1"></i> Settings
								</a>
							</li>
						</ul>
					</div>
				</div>
			</nav>

			<div class="container mt-4">
				<h1 class="text-center text-white mb-2">User Settings</h1>
				<p class="lead text-center text-white">
					Manage your preferences and API keys
				</p>
			</div>
		</header>

		<main class="container py-5">
			<div class="settings-container">
				<div class="settings-card">
					<h3>API Integration Settings</h3>
					<p>
						Configure API keys to enhance your learning experience
						with additional features.
					</p>

					<!-- Gemini API Settings -->
					<div class="form-group">
						<label class="form-label">
							Google Gemini API
							<span
								id="gemini-status"
								class="api-status status-inactive"
								>Inactive</span
							>
						</label>
						<div class="input-group">
							<input
								type="password"
								id="gemini-api-key"
								class="form-control"
								placeholder="Enter your Gemini API Key"
							/>
							<span
								class="input-group-text"
								id="toggle-gemini-visibility"
							>
								<i class="fas fa-eye-slash"></i>
							</span>
						</div>
						<div class="form-text">
							Used for AI-assisted learning features like
							personalized explanations and answering questions.
							<a
								href="https://ai.google.dev/"
								target="_blank"
								class="get-api-link"
								>Get your Gemini API key
								<i class="fas fa-external-link-alt"></i></a
							>
						</div>
					</div>

					<div
						id="api-message"
						class="alert alert-info d-none"
					></div>

					<div class="settings-footer">
						<button
							id="clear-image-cache"
							class="btn btn-outline-secondary"
						>
							Clear Image Cache
						</button>
						<button
							id="reset-api-key"
							class="btn btn-outline-danger"
						>
							Reset API Key
						</button>
						<button id="save-api-key" class="btn btn-primary">
							Save Changes
						</button>
					</div>
				</div>

				<div class="settings-card">
					<h3>Appearance Settings</h3>

					<!-- Theme Preference -->
					<div class="form-group">
						<label class="form-label">Theme Preference</label>
						<select id="theme-preference" class="form-select">
							<option value="light">Light</option>
							<option value="dark">Dark</option>
							<option value="system">System Default</option>
						</select>
						<div class="form-text">
							Choose your preferred theme for the application.
						</div>
					</div>

						<!-- Font Size -->
					<div class="form-group">
						<label class="form-label">Text Size</label>
						<div class="d-flex align-items-center">
							<input type="range" class="form-range w-75" id="text-size-slider" min="80" max="120" step="5" value="100">
							<span class="ms-3" id="text-size-value">100%</span>
						</div>
						<div class="form-text">
							Adjust the text size across the platform.
						</div>
					</div>

					<!-- Text Spacing -->
					<div class="form-group">
						<label class="form-label">Reading Comfort</label>
						<div class="form-check">
							<input class="form-check-input" type="checkbox" id="enable-line-spacing">
							<label class="form-check-label" for="enable-line-spacing">
								Increased line spacing
							</label>
						</div>
						<div class="form-check">
							<input class="form-check-input" type="checkbox" id="enable-dyslexia-font">
							<label class="form-check-label" for="enable-dyslexia-font">
								Dyslexia-friendly font
							</label>
						</div>
						<div class="form-text">
							Make reading course content more comfortable.
						</div>
					</div>

					<div class="settings-footer">
						<button id="save-appearance-settings" class="btn btn-primary">Save Changes</button>
					</div>
				</div>

				<div class="settings-card">
					<h3>Learning Preferences</h3>

					<!-- Study Mode -->
					<div class="form-group">
						<label class="form-label">Study Mode</label>
						<select id="study-mode" class="form-select">
							<option value="standard">Standard</option>
							<option value="focus">Focus Mode (Hide Distractions)</option>
							<option value="interactive">Interactive Mode (More Activities)</option>
						</select>
						<div class="form-text">
							Controls how course content is presented to you.
						</div>
					</div>

					<!-- Learning Pace -->
					<div class="form-group">
						<label class="form-label">Learning Pace</label>
						<select id="learning-pace" class="form-select">
							<option value="self">Self-Paced (Default)</option>
							<option value="structured">Structured Schedule</option>
							<option value="accelerated">Accelerated Learning</option>
						</select>
						<div class="form-text">
							How you prefer to progress through courses.
						</div>
					</div>

					<!-- Content Preferences -->
					<div class="form-group">
						<label class="form-label">Content Preferences</label>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="prefer-video" checked>
							<label class="form-check-label" for="prefer-video">Prioritize video content</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="prefer-examples" checked>
							<label class="form-check-label" for="prefer-examples">Show more examples</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="auto-play-videos">
							<label class="form-check-label" for="auto-play-videos">Auto-play videos</label>
						</div>
					</div>

					<div class="settings-footer">
						<button id="save-learning-settings" class="btn btn-primary">Save Changes</button>
					</div>
				</div>
<!--
				<div class="settings-card">
					<h3>Notification Settings</h3>

					<div class="form-group">
						<label class="form-label">Receive Notifications For</label>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="notification-course-updates" checked>
							<label class="form-check-label" for="notification-course-updates">Course updates</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="notification-reminders" checked>
							<label class="form-check-label" for="notification-reminders">Learning reminders</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="notification-achievements">
							<label class="form-check-label" for="notification-achievements">Achievement milestones</label>
						</div>
						<div class="form-check form-switch">
							<input class="form-check-input" type="checkbox" id="notification-promotions">
							<label class="form-check-label" for="notification-promotions">Promotions and news</label>
						</div>
					</div>

					<div class="form-group">
						<label class="form-label">Reminder Frequency</label>
						<select id="reminder-frequency" class="form-select">
							<option value="daily">Daily</option>
							<option value="weekdays">Weekdays only</option>
							<option value="weekly">Weekly</option>
							<option value="never">Never</option>
						</select>
						<div class="form-text">
							How often you'd like to receive learning reminders.
						</div>
					</div>
-->

					<div class="settings-footer">
						<button id="save-notification-settings" class="btn btn-primary">Save Changes</button>
					</div>
				</div>

				<div class="settings-card">
					<h3>User Profile</h3>

					<!-- Username -->
					<div class="form-group">
						<label class="form-label">Display Name</label>
						<input type="text" id="display-name" class="form-control" placeholder="Your display name">
						<div class="form-text">
							This name will be shown throughout the platform.
						</div>
					</div>

					<!-- Learning Focus -->
					<div class="form-group">
						<label class="form-label">Learning Interests</label>
						<select id="learning-interests" class="form-select" multiple size="4">
							<option value="programming">Programming</option>
							<option value="data-science">Data Science</option>
							<option value="design">Design</option>
							<option value="business">Business</option>
							<option value="marketing">Marketing</option>
							<option value="personal-development">Personal Development</option>
						</select>
						<div class="form-text">
							Hold Ctrl/Cmd to select multiple interests. This helps us recommend relevant courses.
						</div>
					</div>

					<div class="settings-footer">
						<button id="save-profile-settings" class="btn btn-primary">Save Changes</button>
					</div>
				</div>

				<div class="settings-card">
					<h3>Data Management</h3>

					<div class="form-group">
						<label class="form-label">Course Progress Data</label>
						<div class="d-grid gap-2">
							<button id="export-progress" class="btn btn-outline-primary">
								<i class="fas fa-download me-2"></i>Export Progress Data
							</button>
							<button id="reset-all-progress" class="btn btn-outline-danger">
								<i class="fas fa-trash me-2"></i>Reset All Course Progress
							</button>
						</div>
						<div class="form-text mt-2">
							Export saves your progress data as a JSON file. Resetting removes all progress from all courses.
						</div>
					</div>

					<div class="settings-footer">
						<button id="clear-all-data" class="btn btn-danger">Clear All User Data</button>
					</div>
				</div>
			</div>
		</main>

		<footer>
			<div class="container">
				<p>&copy; 2025 VKrishna04 eVidya Tech Courses. All rights reserved.</p>
			</div>
		</footer>

		<!-- Bootstrap JS Bundle with Popper -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<!-- Load the config first -->
		<script src="../js/config.js"></script>
		<script>
			// DOM elements
			const geminiApiKeyInput = document.getElementById("gemini-api-key");
			const geminiStatusEl = document.getElementById("gemini-status");
			const saveApiKeyBtn = document.getElementById("save-api-key");
			const resetApiKeyBtn = document.getElementById("reset-api-key");
			const clearImageCacheBtn = document.getElementById("clear-image-cache");
			const apiMessageEl = document.getElementById("api-message");

			// Appearance settings elements
			const themePreferenceSelect = document.getElementById("theme-preference");
			const textSizeSlider = document.getElementById("text-size-slider");
			const textSizeValue = document.getElementById("text-size-value");
			const enableLineSpacing = document.getElementById("enable-line-spacing");
			const enableDyslexiaFont = document.getElementById("enable-dyslexia-font");
			const saveAppearanceBtn = document.getElementById("save-appearance-settings");

			// Learning preferences elements
			const studyModeSelect = document.getElementById("study-mode");
			const learningPaceSelect = document.getElementById("learning-pace");
			const preferVideoCheck = document.getElementById("prefer-video");
			const preferExamplesCheck = document.getElementById("prefer-examples");
			const autoPlayVideosCheck = document.getElementById("auto-play-videos");
			const saveLearningBtn = document.getElementById("save-learning-settings");

			// Notification settings elements
			const notificationCourseUpdates = document.getElementById("notification-course-updates");
			const notificationReminders = document.getElementById("notification-reminders");
			const notificationAchievements = document.getElementById("notification-achievements");
			const notificationPromotions = document.getElementById("notification-promotions");
			const reminderFrequencySelect = document.getElementById("reminder-frequency");
			const saveNotificationBtn = document.getElementById("save-notification-settings");

			// User profile elements
			const displayNameInput = document.getElementById("display-name");
			const learningInterestsSelect = document.getElementById("learning-interests");
			const saveProfileBtn = document.getElementById("save-profile-settings");

			// Data management elements
			const exportProgressBtn = document.getElementById("export-progress");
			const resetAllProgressBtn = document.getElementById("reset-all-progress");
			const clearAllDataBtn = document.getElementById("clear-all-data");

			// Toggle password visibility
			const toggleGeminiVisibility = document.getElementById("toggle-gemini-visibility");

			// Load all settings from localStorage
			function loadAllSettings() {
				// Load API key
				loadApiKey();

				// Load appearance settings
				loadAppearanceSettings();

				// Load learning preferences
				loadLearningPreferences();

				// Load notification settings
				loadNotificationSettings();

				// Load user profile
				loadUserProfile();

				// Apply current appearance settings
				applyAppearanceSettings();
			}

			// API key functions
			function loadApiKey() {
				const geminiApiKey = localStorage.getItem("gemini_api_key") || "";
				geminiApiKeyInput.value = geminiApiKey;
				updateGeminiStatus(geminiApiKey);
			}

			function updateGeminiStatus(apiKey) {
				if (apiKey && apiKey.trim() !== "") {
					geminiStatusEl.className = "api-status status-active";
					geminiStatusEl.textContent = "Active";
				} else {
					geminiStatusEl.className = "api-status status-inactive";
					geminiStatusEl.textContent = "Inactive";
				}
			}

			function saveApiKey() {
				const geminiApiKey = geminiApiKeyInput.value.trim();
				localStorage.setItem("gemini_api_key", geminiApiKey);
				updateGeminiStatus(geminiApiKey);
				showMessage(apiMessageEl, "API key saved successfully!", "success");
			}

			function resetApiKey() {
				if (confirm("Are you sure you want to reset the API key? This action cannot be undone.")) {
					geminiApiKeyInput.value = "";
					localStorage.removeItem("gemini_api_key");
					updateGeminiStatus("");
					showMessage(apiMessageEl, "API key has been reset.", "info");
				}
			}

			// Appearance settings functions
			function loadAppearanceSettings() {
				// Theme preference
				const theme = localStorage.getItem("theme_preference") || "light";
				themePreferenceSelect.value = theme;

				// Text size
				const textSize = localStorage.getItem("text_size") || "100";
				textSizeSlider.value = textSize;
				textSizeValue.textContent = textSize + "%";

				// Reading comfort
				enableLineSpacing.checked = localStorage.getItem("enable_line_spacing") === "true";
				enableDyslexiaFont.checked = localStorage.getItem("enable_dyslexia_font") === "true";
			}

			function saveAppearanceSettings() {
				// Save theme
				localStorage.setItem("theme_preference", themePreferenceSelect.value);

				// Save text size
				localStorage.setItem("text_size", textSizeSlider.value);

				// Save reading comfort settings
				localStorage.setItem("enable_line_spacing", enableLineSpacing.checked);
				localStorage.setItem("enable_dyslexia_font", enableDyslexiaFont.checked);

				// Apply settings immediately
				applyAppearanceSettings();

				// Show success message
				showSettingsMessage(saveAppearanceBtn, "Appearance settings saved!");
			}

			function applyAppearanceSettings() {
				// Apply theme
				const theme = localStorage.getItem("theme_preference") || "light";
				document.body.classList.remove("theme-light", "theme-dark");

				if (theme === "dark") {
					document.body.classList.add("theme-dark");
				} else if (theme === "system") {
					// Check system preference
					if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
						document.body.classList.add("theme-dark");
					}
				} else {
					document.body.classList.add("theme-light");
				}

				// Apply text size
				const textSize = localStorage.getItem("text_size") || "100";
				document.documentElement.style.fontSize = `${textSize}%`;

				// Apply reading comfort settings
				if (localStorage.getItem("enable_line_spacing") === "true") {
					document.body.classList.add("increased-line-spacing");
				} else {
					document.body.classList.remove("increased-line-spacing");
				}

				if (localStorage.getItem("enable_dyslexia_font") === "true") {
					document.documentElement.style.fontFamily = "'OpenDyslexic', sans-serif";
				} else {
					document.documentElement.style.fontFamily = "'Poppins', sans-serif";
				}
			}

			// Learning preferences functions
			function loadLearningPreferences() {
				studyModeSelect.value = localStorage.getItem("study_mode") || "standard";
				learningPaceSelect.value = localStorage.getItem("learning_pace") || "self";
				preferVideoCheck.checked = localStorage.getItem("prefer_video") !== "false";
				preferExamplesCheck.checked = localStorage.getItem("prefer_examples") !== "false";
				autoPlayVideosCheck.checked = localStorage.getItem("auto_play_videos") === "true";
			}

			function saveLearningPreferences() {
				localStorage.setItem("study_mode", studyModeSelect.value);
				localStorage.setItem("learning_pace", learningPaceSelect.value);
				localStorage.setItem("prefer_video", preferVideoCheck.checked);
				localStorage.setItem("prefer_examples", preferExamplesCheck.checked);
				localStorage.setItem("auto_play_videos", autoPlayVideosCheck.checked);

				showSettingsMessage(saveLearningBtn, "Learning preferences saved!");
			}

			// Notification settings functions
			function loadNotificationSettings() {
				notificationCourseUpdates.checked = localStorage.getItem("notification_course_updates") !== "false";
				notificationReminders.checked = localStorage.getItem("notification_reminders") !== "false";
				notificationAchievements.checked = localStorage.getItem("notification_achievements") === "true";
				notificationPromotions.checked = localStorage.getItem("notification_promotions") === "true";
				reminderFrequencySelect.value = localStorage.getItem("reminder_frequency") || "daily";
			}

			function saveNotificationSettings() {
				localStorage.setItem("notification_course_updates", notificationCourseUpdates.checked);
				localStorage.setItem("notification_reminders", notificationReminders.checked);
				localStorage.setItem("notification_achievements", notificationAchievements.checked);
				localStorage.setItem("notification_promotions", notificationPromotions.checked);
				localStorage.setItem("reminder_frequency", reminderFrequencySelect.value);

				showSettingsMessage(saveNotificationBtn, "Notification settings saved!");
			}

			// User profile functions
			function loadUserProfile() {
				// Load display name
				displayNameInput.value = localStorage.getItem("display_name") || "";

				// Load learning interests
				const interests = localStorage.getItem("learning_interests");
				if (interests) {
					const interestsArray = JSON.parse(interests);

					// Select all options that match the interests
					Array.from(learningInterestsSelect.options).forEach(option => {
						option.selected = interestsArray.includes(option.value);
					});
				}
			}

			function saveUserProfile() {
				// Save display name
				localStorage.setItem("display_name", displayNameInput.value);

				// Save learning interests
				const selectedInterests = Array.from(learningInterestsSelect.selectedOptions).map(option => option.value);
				localStorage.setItem("learning_interests", JSON.stringify(selectedInterests));

				showSettingsMessage(saveProfileBtn, "Profile saved successfully!");

				// Update display name across the site
				updateDisplayName();
			}

			function updateDisplayName() {
				const name = localStorage.getItem("display_name");
				if (name) {
					// This would update any elements showing the user's name
					// For example, if there's a user-name element in the header
					const userNameElements = document.querySelectorAll(".user-name");
					userNameElements.forEach(el => {
						el.textContent = name;
					});
				}
			}

			// Data management functions
			function exportProgressData() {
				const progressData = {
					courseProgress: JSON.parse(localStorage.getItem("courseProgress") || "{}"),
					completedLessons: JSON.parse(localStorage.getItem("completedLessons") || "{}"),
					completedQuizzes: JSON.parse(localStorage.getItem("completedQuizzes") || "{}"),
					watchedVideos: JSON.parse(localStorage.getItem("watchedVideos") || "{}"),
					timestamp: new Date().toISOString()
				};

				// Create a blob and download link
				const dataStr = JSON.stringify(progressData, null, 2);
				const dataBlob = new Blob([dataStr], { type: "application/json" });
				const url = URL.createObjectURL(dataBlob);

				// Create and trigger download
				const a = document.createElement("a");
				a.href = url;
				a.download = `eVidya_progress_${new Date().toLocaleDateString().replace(/\//g, "-")}.json`;
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
				URL.revokeObjectURL(url);

				showMessage(apiMessageEl, "Progress data exported successfully!", "success");
			}

			function resetAllProgress() {
				if (confirm("Are you sure you want to reset ALL course progress? This cannot be undone.")) {
					localStorage.removeItem("courseProgress");
					localStorage.removeItem("completedLessons");
					localStorage.removeItem("completedQuizzes");
					localStorage.removeItem("watchedVideos");

					showMessage(apiMessageEl, "All course progress has been reset.", "warning");
				}
			}

			function clearAllUserData() {
				if (confirm("⚠️ WARNING: This will delete ALL your user data including progress, settings, and preferences. This action CANNOT be undone. Are you absolutely sure?")) {
					// Get current API key before clearing (optional, in case we want to preserve it)
					const apiKey = localStorage.getItem("gemini_api_key");

					// Clear all localStorage
					localStorage.clear();

					// Optionally restore API key if needed
					if (apiKey && confirm("Would you like to keep your Gemini API key?")) {
						localStorage.setItem("gemini_api_key", apiKey);
					}

					showMessage(apiMessageEl, "All user data has been cleared. The page will reload.", "warning");

					// Reload page after a short delay
					setTimeout(() => {
						window.location.reload();
					}, 2000);
				}
			}

			// Utility functions
			function togglePasswordVisibility(inputEl, toggleEl) {
				const type = inputEl.getAttribute("type") === "password" ? "text" : "password";
				inputEl.setAttribute("type", type);

				// Toggle icon
				const iconEl = toggleEl.querySelector("i");
				if (type === "text") {
					iconEl.className = "fas fa-eye";
				} else {
					iconEl.className = "fas fa-eye-slash";
				}
			}

			function showMessage(element, message, type) {
				element.textContent = message;
				element.className = `alert alert-${type}`;
				element.classList.remove("d-none");

				// Hide after 5 seconds
				setTimeout(() => {
					element.classList.add("d-none");
				}, 5000);
			}

			function showSettingsMessage(buttonElement, message) {
				// Create a temporary success message
				const messageEl = document.createElement("div");
				messageEl.className = "alert alert-success mt-3";
				messageEl.textContent = message;

				// Insert after the button's parent (settings-footer)
				const parentEl = buttonElement.closest(".settings-footer");
				parentEl.parentNode.insertBefore(messageEl, parentEl.nextSibling);

				// Remove after 3 seconds
				setTimeout(() => {
					messageEl.remove();
				}, 3000);
			}

			// Text size slider update
			textSizeSlider.addEventListener("input", function() {
				textSizeValue.textContent = this.value + "%";
				document.documentElement.style.fontSize = `${this.value}%`;
			});

			// Event listeners
			document.addEventListener("DOMContentLoaded", function() {
				// Load all settings
				loadAllSettings();

				// API key
				saveApiKeyBtn.addEventListener("click", saveApiKey);
				resetApiKeyBtn.addEventListener("click", resetApiKey);
				toggleGeminiVisibility.addEventListener("click", () => togglePasswordVisibility(geminiApiKeyInput, toggleGeminiVisibility));

				// Clear image cache
				clearImageCacheBtn.addEventListener("click", function() {
					if (confirm("Are you sure you want to clear the image cache? This will reset all course thumbnail images.")) {
						const clearedCount = config.images.clearImageCache();
						showMessage(apiMessageEl, `Image cache cleared successfully (${clearedCount} images). Refresh pages to see new images.`, "info");
					}
				});

				// Appearance settings
				saveAppearanceBtn.addEventListener("click", saveAppearanceSettings);

				// Learning preferences
				saveLearningBtn.addEventListener("click", saveLearningPreferences);

				// Notification settings
				saveNotificationBtn.addEventListener("click", saveNotificationSettings);

				// User profile
				saveProfileBtn.addEventListener("click", saveUserProfile);

				// Data management
				exportProgressBtn.addEventListener("click", exportProgressData);
				resetAllProgressBtn.addEventListener("click", resetAllProgress);
				clearAllDataBtn.addEventListener("click", clearAllUserData);

				// Check for system dark mode changes
				if (window.matchMedia) {
					window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', applyAppearanceSettings);
				}
			});
		</script>
	</body>
</html>
